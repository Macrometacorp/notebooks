
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Py09 - CI/CD Tutorial &#8212; GDN - XBook</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/theme.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Javascript" href="../javascript/beginner_toc.html" />
    <link rel="prev" title="Py08 - Stream Workers" href="08_stream_worker%28Python%29.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo-macrometa.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">GDN - XBook</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Macrometa GDN - XBook
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Beginner
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="beginner_toc.html">
   Python
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="00_working_with_pyc8%28Python%29.html">
     Py00 - Working with PyC8
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="01_connect_gdn%28Python%29.html">
     Py01 - Connecting to GDN
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_key_value_store%28Python%29.html">
     Py02 - Key Value Store
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_docs_store%28Python%29.html">
     Py03 - Documents Store
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04_graphs%28Python%29.html">
     Py04 - Working with Graphs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="05_graph_traversals%28Python%29.html">
     Py05 - Graph Traversals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="06_building_restql_apis%28Python%29.html">
     Py06 - Query Workers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="07_working_with_fabrics%28Python%29.html">
     Py07 - GeoFabrics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="08_stream_worker%28Python%29.html">
     Py08 - Stream Workers
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Py09 - CI/CD Tutorial
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../javascript/beginner_toc.html">
   Javascript
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../javascript/00_working_with_jsc8%28javascript%29.html">
     JS00 - Working with jsC8
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../javascript/01_connect_gdn%28javascript%29.html">
     JS01 - Connecting to GDN
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../javascript/02_key_value_store%28javascript%29.html">
     JS02 - Key Value Store
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../javascript/03_docs_store%28javascript%29.html">
     JS03 - Documents Store
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../javascript/04_graphs%28javascript%29.html">
     JS04 - Working with Graphs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../javascript/05_graph_traversals%28javascript%29.html">
     JS05 - Graph Traversals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../javascript/06_building_restql_apis%28javascript%29.html">
     JS06 - Query Workers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../javascript/07_working_with_fabrics%28javascript%29.html">
     JS07 - GeoFabrics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../javascript/08_stream_worker%28javascript%29.html">
     JS08 - Stream Workers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../javascript/09_ci_cd_workbook%28javascript%29.html">
     JS09 - CI/CD Tutorial
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../cli/beginner_toc.html">
   CLI
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../cli/00_working_with_gdnsl%28CLI%29.html">
     CLI00 - Working with the gdnsl CLI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cli/01_connect_gdn%28CLI%29.html">
     CLI01 - Connecting to GDN
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cli/02_key_value_store%28CLI%29.html">
     CLI02 - Key Value Store
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cli/03_docs_store%28CLI%29.html">
     CLI03 - Documents Store
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cli/04_graphs%28CLI%29.html">
     CLI04 - Working with Graphs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cli/05_graph_traversals%28CLI%29.html">
     CLI05 - Graph Traversals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cli/06_building_restql_apis%28CLI%29.html">
     CLI06 - Query Workers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cli/07_working_with_fabrics%28CLI%29.html">
     CLI07 - GeoFabrics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cli/08_stream_worker%28CLI%29.html">
     CLI08 - Stream Workers
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Advanced
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../advanced_python/advanced_toc.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../advanced_python/XX_address_book%28Python%29.html">
     PyXX - Address Book App
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/python/09_ci_cd_workbook(Python).ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/Macrometacorp/docs-xbook"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/Macrometacorp/docs-xbook/issues/new?title=Issue%20on%20page%20%2Fpython/09_ci_cd_workbook(Python).html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/Macrometacorp/docs-xbook/blob/main/python/09_ci_cd_workbook(Python).ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview">
   Overview
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pre-requisite">
   Pre-requisite
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#importing-libraries-define-variables">
   1. Importing Libraries &amp; Define Variables
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#connecting-to-gdn">
   2. Connecting to GDN
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-helper-functions">
   3. Creating Helper Functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-ci-cd-pipeline">
   4. Create CI/CD Pipeline
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#execute-ci-cd-script">
   5. Execute CI/CD script
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-completed">
   Section Completed!
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Py09 - CI/CD Tutorial</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview">
   Overview
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pre-requisite">
   Pre-requisite
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#importing-libraries-define-variables">
   1. Importing Libraries &amp; Define Variables
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#connecting-to-gdn">
   2. Connecting to GDN
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-helper-functions">
   3. Creating Helper Functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-ci-cd-pipeline">
   4. Create CI/CD Pipeline
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#execute-ci-cd-script">
   5. Execute CI/CD script
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-completed">
   Section Completed!
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="py09-ci-cd-tutorial">
<h1>Py09 - CI/CD Tutorial<a class="headerlink" href="#py09-ci-cd-tutorial" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>In this tutorial we will build a simple CI/CD script for GDN plateform</p>
</div>
<div class="section" id="pre-requisite">
<h2>Pre-requisite<a class="headerlink" href="#pre-requisite" title="Permalink to this headline">¶</a></h2>
<p>Let’s assume your</p>
<ul class="simple">
<li><p>tenant name is an email address</p></li>
<li><p>user password is xxxxx.</p></li>
</ul>
<p>if you need to install pyc8, you can run the cell below, otherwise you may skip it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip install pyC8
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="importing-libraries-define-variables">
<h2>1. Importing Libraries &amp; Define Variables<a class="headerlink" href="#importing-libraries-define-variables" title="Permalink to this headline">¶</a></h2>
<p>The first step is to import the libraries we need and define the variables we will be using in this tutorial. This is also the right place to add your GDN login credentials. i.e. your email and password. You will also need to make sure you have specified the correct federation URL. In this example it is “<a class="reference external" href="http://gdn.paas.macrometa.io">gdn.paas.macrometa.io</a>” and we are using the default geo fabric “_system”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">c8</span> <span class="kn">import</span> <span class="n">C8Client</span>
<span class="kn">from</span> <span class="nn">c8.request</span> <span class="kn">import</span> <span class="n">Request</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">six</span>
<span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">threading</span>

<span class="c1"># Variables</span>
<span class="n">global_url</span> <span class="o">=</span> <span class="s2">&quot;gdn.paas.macrometa.io&quot;</span>
<span class="n">email</span> <span class="o">=</span> <span class="s2">&quot;email&quot;</span>  <span class="c1"># &lt;-- Email goes here</span>
<span class="n">password</span> <span class="o">=</span> <span class="s2">&quot;password&quot;</span>  <span class="c1"># &lt;-- password goes here</span>
<span class="n">geo_fabric</span> <span class="o">=</span> <span class="s2">&quot;_system&quot;</span>

<span class="n">COLLECTION_TYPE</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;DOCUMENT&quot;</span><span class="p">:</span> <span class="s2">&quot;document&quot;</span><span class="p">,</span>
    <span class="s2">&quot;KV&quot;</span><span class="p">:</span> <span class="s2">&quot;graph&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">fabric_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;cicd-fabric&quot;</span><span class="p">]</span>

<span class="n">collection_list</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Doc1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">COLLECTION_TYPE</span><span class="p">[</span><span class="s2">&quot;DOCUMENT&quot;</span><span class="p">],</span>
        <span class="s2">&quot;isEdge&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;hasStream&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;noOfInsertOperation&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
        <span class="s2">&quot;noOfUpdateOperation&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;noOfDeleteOperations&quot;</span><span class="p">:</span> <span class="mi">100</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Doc2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">COLLECTION_TYPE</span><span class="p">[</span><span class="s2">&quot;DOCUMENT&quot;</span><span class="p">],</span>
        <span class="s2">&quot;isEdge&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;hasStream&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;noOfInsertOperation&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
        <span class="s2">&quot;noOfUpdateOperation&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;noOfDeleteOperations&quot;</span><span class="p">:</span> <span class="mi">100</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;KV1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">COLLECTION_TYPE</span><span class="p">[</span><span class="s2">&quot;KV&quot;</span><span class="p">],</span>
        <span class="s2">&quot;hasStream&quot;</span><span class="p">:</span> <span class="kc">True</span>
    <span class="p">}</span>
<span class="p">]</span>

<span class="n">stream_list</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;gstream&quot;</span><span class="p">,</span>
        <span class="s2">&quot;isLocal&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;noOfInsertOperation&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
        <span class="s2">&quot;noOfUpdateOperation&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;noOfDeleteOperations&quot;</span><span class="p">:</span> <span class="mi">0</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;lstream&quot;</span><span class="p">,</span>
        <span class="s2">&quot;isLocal&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;noOfInsertOperation&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
        <span class="s2">&quot;noOfUpdateOperation&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;noOfDeleteOperations&quot;</span><span class="p">:</span> <span class="mi">0</span>
    <span class="p">}</span>
<span class="p">]</span>

<span class="n">query_worker_list</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;insert_data&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;insertRecord&quot;</span><span class="p">,</span>
        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;&quot;FOR i IN 1..100</span>
<span class="s2">              INSERT {</span>
<span class="s2">                    &quot;firstname&quot;:CONCAT(&quot;Halie&quot;, TO_STRING(i)),</span>
<span class="s2">                    &quot;lastname&quot;:CONCAT(&quot;Linkie&quot;, TO_STRING(i)),</span>
<span class="s2">                    &quot;email&quot;:CONCAT(&quot;hlinkie0&quot;, TO_STRING(i),&quot;@irs.gov&quot;),</span>
<span class="s2">                    &quot;zipcode&quot;: CONCAT(&quot;2950-53&quot;, TO_STRING(i))</span>
<span class="s2">                } INTO COLLECTION_NAME&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;parameter&quot;</span><span class="p">:</span> <span class="p">{},</span>
    <span class="p">},</span>
    <span class="s2">&quot;get_data&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;getRecords&quot;</span><span class="p">,</span>
        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;FOR doc IN COLLECTION_NAME RETURN doc&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;update_data&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;updateRecord&quot;</span><span class="p">,</span>
        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;&quot;FOR doc IN COLLECTION_NAME </span>
<span class="s2">      filter doc.email == &#39;hlinkie05@irs.gov&#39;</span>
<span class="s2">      UPDATE { _key:doc._key,  </span><span class="se">\&quot;</span><span class="s2">lastname</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">cena</span><span class="se">\&quot;</span><span class="s2"> }</span>
<span class="s2">        IN COLLECTION_NAME&quot;&quot;&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;get_count&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;countRecords&quot;</span><span class="p">,</span>
        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;RETURN COUNT(FOR doc IN COLLECTION_NAME RETURN 1)&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;delete_data&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;deleteRecord&quot;</span><span class="p">,</span>
        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;&quot;FOR doc IN COLLECTION_NAME </span>
<span class="s2">          filter doc.email == &#39;hlinkie03@irs.gov&#39;</span>
<span class="s2">          REMOVE doc </span>
<span class="s2">          IN COLLECTION_NAME &quot;&quot;&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;delete_all_data&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;deleteAllRecord&quot;</span><span class="p">,</span>
        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;&quot;FOR doc IN COLLECTION_NAME</span>
<span class="s2">        REMOVE doc </span>
<span class="s2">        IN COLLECTION_NAME &quot;&quot;&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>

<span class="n">graph_list</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;social&quot;</span><span class="p">,</span>
        <span class="s2">&quot;edgeDefinitions&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;collection&quot;</span><span class="p">:</span> <span class="s2">&quot;relation&quot;</span><span class="p">,</span>
            <span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;female&quot;</span><span class="p">,</span> <span class="s2">&quot;male&quot;</span><span class="p">],</span>
            <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;female&quot;</span><span class="p">,</span> <span class="s2">&quot;male&quot;</span><span class="p">],</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;children&quot;</span><span class="p">},</span>
<span class="p">]</span>

<span class="n">stream_worker_list</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;MockHeartRateDataGenerator&quot;</span><span class="p">,</span>
        <span class="s2">&quot;definition&quot;</span><span class="p">:</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">@App:name(&quot;MockHeartRateDataGenerator&quot;)</span>
<span class="s1">@App:qlVersion(&quot;2&quot;)</span>

<span class="s1">CREATE TRIGGER HeartRateDataGeneratorTrigger WITH ( interval = 10 sec );</span>

<span class="s1">CREATE TABLE HeartRates (name string, bpm int);</span>


<span class="s1">-- Note: Generating random bpm and name </span>
<span class="s1">@info(name = &#39;ConsumeProcessedData&#39;)</span>
<span class="s1">INSERT INTO HeartRates</span>
<span class="s1">SELECT </span>
<span class="s1">js:eval(&quot;[&#39;Vasili&#39;, &#39;Rivalee&#39;, &#39;Betty&#39;, &#39;Jennifer&#39;, &#39;Alane&#39;, &#39;Sarena&#39;, &#39;Bruno&#39;, &#39;Carolee&#39;, &#39;Emmott&#39;, &#39;Andre&#39;][Math.floor(Math.random() * 10)]&quot;,&quot;string&quot;) as name,</span>
<span class="s1">js:eval(&quot;Math.floor(Math.random() * 40) + 40&quot;,&quot;int&quot;) as bpm</span>
<span class="s1">FROM HeartRateDataGeneratorTrigger;</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">]</span>

<span class="n">web_socket_data</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">web_socket_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">active_fabric</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

<span class="n">DOCUMENT_OPERATIONS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;UPDATE&quot;</span><span class="p">:</span> <span class="s2">&quot;UPDATE&quot;</span><span class="p">,</span>
    <span class="s2">&quot;INSERT&quot;</span><span class="p">:</span> <span class="s2">&quot;INSERT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DELETE&quot;</span><span class="p">:</span> <span class="s2">&quot;DELETE&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">info</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;noOfCollection&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;noOfStreamWorker&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;noOfQueryWorker&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;noOfStream&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;noOfFabric&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;noOfGraph&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="connecting-to-gdn">
<h2>2. Connecting to GDN<a class="headerlink" href="#connecting-to-gdn" title="Permalink to this headline">¶</a></h2>
<p>Now that we have imported the required libraries and added our login details, we can connect to GDN. Do this by running the cell bellow.</p>
<p>You will see the cell output reflect a successful connection. If not go back to the first step and check the details you entered.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ------- CONNECTION SETUP  ------&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tenant: </span><span class="si">{}</span><span class="s2">, geofabric:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">email</span><span class="p">,</span> <span class="n">geo_fabric</span><span class="p">))</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">C8Client</span><span class="p">(</span><span class="n">protocol</span><span class="o">=</span><span class="s1">&#39;https&#39;</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="n">global_url</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">443</span><span class="p">,</span>
                  <span class="n">email</span><span class="o">=</span><span class="n">email</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span>
                  <span class="n">geofabric</span><span class="o">=</span><span class="n">geo_fabric</span><span class="p">)</span>

<span class="n">tenant</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">tenant</span><span class="p">(</span><span class="n">email</span><span class="o">=</span><span class="n">email</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">)</span>
<span class="n">current_fabric</span> <span class="o">=</span> <span class="n">tenant</span><span class="o">.</span><span class="n">useFabric</span><span class="p">(</span><span class="n">geo_fabric</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="creating-helper-functions">
<h2>3. Creating Helper Functions<a class="headerlink" href="#creating-helper-functions" title="Permalink to this headline">¶</a></h2>
<p>Helper functions are basic building blocks for the CI/CD pipeline. These functions are responsible for creating/deleting collection, streams, query worker, stream worker, etc. based on the list provied in the section 1.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Logger function</span>
<span class="k">def</span> <span class="nf">log</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[</span><span class="si">{date}</span><span class="s2">]: </span><span class="si">{message}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
      <span class="n">date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span> <span class="n">message</span><span class="o">=</span><span class="n">message</span><span class="p">))</span>

<span class="c1"># Generate the random numbers</span>
<span class="k">def</span> <span class="nf">get_random_number</span><span class="p">(</span><span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">):</span>
  <span class="k">if</span> <span class="nb">min</span> <span class="o">==</span> <span class="nb">max</span><span class="p">:</span>
    <span class="k">return</span> <span class="nb">min</span>
  <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Create the document collection</span>
<span class="k">def</span> <span class="nf">create_document_collection</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">has_stream</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_edge</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
  <span class="n">has_collection</span> <span class="o">=</span> <span class="n">current_fabric</span><span class="o">.</span><span class="n">has_collection</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">has_collection</span><span class="p">:</span>
    <span class="k">return</span>
  <span class="n">current_fabric</span><span class="o">.</span><span class="n">create_collection</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">edge</span><span class="o">=</span><span class="n">is_edge</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">has_stream</span><span class="p">:</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span>
        <span class="n">method</span><span class="o">=</span><span class="s1">&#39;put&#39;</span><span class="p">,</span>
        <span class="n">endpoint</span><span class="o">=</span><span class="s1">&#39;/collection/</span><span class="si">{}</span><span class="s1">/stream&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">),</span>
        <span class="n">data</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;hasStream&quot;</span><span class="p">:</span> <span class="kc">True</span>
        <span class="p">}</span>
    <span class="p">)</span>

  <span class="k">def</span> <span class="nf">response_handler</span><span class="p">(</span><span class="n">resp</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">resp</span><span class="o">.</span><span class="n">is_success</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Failed to update stream flag </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
  <span class="c1"># In upcoming release this API call will be replaced by pyc8 internal function</span>
  <span class="n">current_fabric</span><span class="o">.</span><span class="n">_execute</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">response_handler</span><span class="p">)</span>
  <span class="n">info</span><span class="p">[</span><span class="s2">&quot;noOfCollection&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>


<span class="c1"># Create the kv collection</span>
<span class="k">def</span> <span class="nf">create_kv_collection</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">has_stream</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
  <span class="n">has_collection</span> <span class="o">=</span> <span class="n">current_fabric</span><span class="o">.</span><span class="n">key_value</span><span class="o">.</span><span class="n">has_collection</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">has_collection</span><span class="p">:</span>
    <span class="k">return</span>
  <span class="n">current_fabric</span><span class="o">.</span><span class="n">key_value</span><span class="o">.</span><span class="n">create_collection</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;stream&quot;</span><span class="p">:</span> <span class="n">has_stream</span><span class="p">})</span>
  <span class="n">info</span><span class="p">[</span><span class="s2">&quot;noOfCollection&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c1"># Create the query workers</span>
<span class="k">def</span> <span class="nf">create_query_worker</span><span class="p">(</span><span class="n">query_worker</span><span class="p">,</span> <span class="n">query_worker_list</span><span class="p">):</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">collection</span> <span class="ow">in</span> <span class="n">collection_list</span><span class="p">:</span>
      <span class="n">query_worker_name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{collectionName}</span><span class="s2">_</span><span class="si">{queryWorkerName}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
          <span class="n">collectionName</span><span class="o">=</span><span class="n">collection</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">queryWorkerName</span><span class="o">=</span><span class="n">query_worker</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>
      <span class="k">if</span> <span class="n">collection</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">COLLECTION_TYPE</span><span class="p">[</span><span class="s2">&quot;DOCUMENT&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">query_worker_name</span> <span class="ow">in</span> <span class="n">query_worker_list</span><span class="p">:</span>
        <span class="k">continue</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;parameter&quot;</span><span class="p">:</span> <span class="n">query_worker</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;parameter&quot;</span><span class="p">,</span> <span class="p">{}),</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">query_worker_name</span><span class="p">,</span>
                <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">query_worker</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;COLLECTION_NAME&quot;</span><span class="p">,</span> <span class="n">collection</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">current_fabric</span><span class="o">.</span><span class="n">save_restql</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
  <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;Error while creating query worker </span><span class="si">{queryWorker}</span><span class="s2"> : -- </span><span class="si">{err}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">queryWorker</span><span class="o">=</span><span class="n">query_worker</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">err</span><span class="o">=</span><span class="n">error</span><span class="p">))</span>

<span class="c1"># Create the GeoFabric</span>
<span class="k">def</span> <span class="nf">create_fabric</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">fabric_list</span><span class="p">,</span> <span class="n">local_dc_name</span><span class="p">,</span> <span class="n">all_dc_list</span><span class="p">):</span>
  <span class="n">global_dc_list</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_dc_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span>
                       <span class="p">[</span><span class="n">all_dc_list</span><span class="p">[</span><span class="n">get_random_number</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_dc_list</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span>
                        <span class="n">all_dc_list</span><span class="p">[</span><span class="n">get_random_number</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_dc_list</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span> <span class="p">]</span>
                       <span class="p">)</span>
  <span class="n">global_dc_list</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">local_dc_name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">fabric_list</span><span class="p">:</span>
    <span class="k">return</span>
  <span class="n">current_fabric</span><span class="o">.</span><span class="n">create_fabric</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">dclist</span><span class="o">=</span><span class="n">global_dc_list</span><span class="p">)</span>
  <span class="n">info</span><span class="p">[</span><span class="s2">&quot;noOfFabric&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c1"># Create the graph</span>
<span class="k">def</span> <span class="nf">crate_graph</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">details</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="n">has_graph</span> <span class="o">=</span> <span class="n">current_fabric</span><span class="o">.</span><span class="n">has_graph</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">has_graph</span><span class="p">:</span>
    <span class="k">return</span>
  <span class="n">graph</span> <span class="o">=</span> <span class="n">current_fabric</span><span class="o">.</span><span class="n">create_graph</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">details</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">create_edge_definition</span><span class="p">(</span>
        <span class="n">edge_collection</span><span class="o">=</span><span class="n">details</span><span class="p">[</span><span class="s2">&quot;collection&quot;</span><span class="p">],</span>
        <span class="n">from_vertex_collections</span><span class="o">=</span><span class="n">details</span><span class="p">[</span><span class="s2">&quot;from&quot;</span><span class="p">],</span>
        <span class="n">to_vertex_collections</span><span class="o">=</span><span class="n">details</span><span class="p">[</span><span class="s2">&quot;to&quot;</span><span class="p">]</span>
    <span class="p">)</span>
  <span class="n">info</span><span class="p">[</span><span class="s2">&quot;noOfGraph&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c1"># Create the stream</span>
<span class="k">def</span> <span class="nf">create_stream</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">is_local</span><span class="p">):</span>
  <span class="n">is_stream_exist</span> <span class="o">=</span> <span class="n">current_fabric</span><span class="o">.</span><span class="n">has_stream</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">local</span><span class="o">=</span><span class="n">is_local</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">is_stream_exist</span><span class="p">:</span>
    <span class="k">return</span>
  <span class="n">current_fabric</span><span class="o">.</span><span class="n">create_stream</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">is_local</span><span class="p">)</span>
  <span class="n">info</span><span class="p">[</span><span class="s2">&quot;noOfStream&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>


<span class="k">def</span> <span class="nf">websocket_listener</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">subscriber</span><span class="p">):</span>
  <span class="k">global</span> <span class="n">web_socket_data</span>
  
  <span class="n">web_socket_data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  <span class="n">web_socket_data</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">DOCUMENT_OPERATIONS</span><span class="p">[</span><span class="s2">&quot;UPDATE&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">web_socket_data</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">DOCUMENT_OPERATIONS</span><span class="p">[</span><span class="s2">&quot;INSERT&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">web_socket_data</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">DOCUMENT_OPERATIONS</span><span class="p">[</span><span class="s2">&quot;DELETE&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
    
  <span class="k">try</span><span class="p">:</span>
      <span class="k">while</span> <span class="n">subscriber</span><span class="o">.</span><span class="n">connected</span><span class="p">:</span>
        <span class="c1">#Listen on stream for any receiving msg&#39;s</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">subscriber</span><span class="o">.</span><span class="n">recv</span><span class="p">())</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">message</span><span class="p">[</span><span class="s2">&quot;payload&quot;</span><span class="p">]))</span>
        <span class="n">operationType</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s2">&quot;op&quot;</span><span class="p">,</span> <span class="n">DOCUMENT_OPERATIONS</span><span class="p">[</span><span class="s2">&quot;INSERT&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">operationType</span> <span class="o">==</span> <span class="n">DOCUMENT_OPERATIONS</span><span class="p">[</span><span class="s2">&quot;UPDATE&quot;</span><span class="p">]:</span>
          <span class="n">web_socket_data</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">DOCUMENT_OPERATIONS</span><span class="p">[</span><span class="s2">&quot;UPDATE&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">operationType</span> <span class="o">==</span> <span class="n">DOCUMENT_OPERATIONS</span><span class="p">[</span><span class="s2">&quot;DELETE&quot;</span><span class="p">]:</span>
          <span class="n">web_socket_data</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">DOCUMENT_OPERATIONS</span><span class="p">[</span><span class="s2">&quot;DELETE&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">web_socket_data</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">DOCUMENT_OPERATIONS</span><span class="p">[</span><span class="s2">&quot;INSERT&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="c1">#Acknowledge the received msg.</span>
        <span class="n">subscriber</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s1">&#39;messageId&#39;</span><span class="p">:</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;messageId&#39;</span><span class="p">]}))</span>
  <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;WebSocket Closed </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>

<span class="c1">#  Create the stream subscriber</span>
<span class="k">def</span> <span class="nf">create_subscriber</span><span class="p">(</span>
    <span class="n">name</span><span class="p">,</span>
    <span class="n">is_local</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">is_collection_stream</span><span class="o">=</span><span class="kc">False</span>
<span class="p">):</span>
  <span class="k">global</span> <span class="n">web_socket_list</span>
  
  <span class="k">try</span><span class="p">:</span>
    <span class="n">subscriber</span> <span class="o">=</span> <span class="n">current_fabric</span><span class="o">.</span><span class="n">stream</span><span class="p">()</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">subscription_name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                                                   <span class="n">local</span><span class="o">=</span><span class="n">is_local</span><span class="p">,</span> <span class="n">isCollectionStream</span><span class="o">=</span><span class="n">is_collection_stream</span><span class="p">)</span>
    <span class="n">web_socket_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subscriber</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">websocket_listener</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">subscriber</span><span class="p">,))</span>
    <span class="n">x</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

  <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
    <span class="n">error</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> \
        <span class="s2">&quot;Error while creating subscriber </span><span class="si">{}</span><span class="s2"> : -- </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
    <span class="k">raise</span> <span class="n">error</span>

<span class="c1"># Create the stream publisher</span>
<span class="k">def</span> <span class="nf">create_publisher</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">is_local</span><span class="p">):</span>
  <span class="k">global</span> <span class="n">web_socket_list</span>
  <span class="n">producer</span> <span class="o">=</span> <span class="n">current_fabric</span><span class="o">.</span><span class="n">stream</span><span class="p">()</span><span class="o">.</span><span class="n">create_producer</span><span class="p">(</span>
      <span class="n">name</span><span class="p">,</span>
      <span class="n">local</span><span class="o">=</span><span class="n">is_local</span>
  <span class="p">)</span>
  <span class="n">web_socket_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">producer</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">message</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;firstname&quot;</span><span class="p">:</span> <span class="s2">&quot;Halie</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
        <span class="s2">&quot;lastname&quot;</span><span class="p">:</span> <span class="s2">&quot;Linkie</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
        <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;hlinkie0</span><span class="si">{}</span><span class="s2">@irs.gov&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
        <span class="s2">&quot;zipcode&quot;</span><span class="p">:</span> <span class="s2">&quot;2950-53</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">six</span><span class="o">.</span><span class="n">b</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">message</span><span class="p">)))</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="n">producer</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">payload</span><span class="p">))</span>

<span class="c1"># Create the stream based on provided stream list in stream_list</span>
<span class="k">def</span> <span class="nf">create_streams</span><span class="p">():</span>
  <span class="k">for</span> <span class="n">stream</span> <span class="ow">in</span> <span class="n">stream_list</span><span class="p">:</span>
    <span class="n">create_stream</span><span class="p">(</span><span class="n">stream</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">stream</span><span class="p">[</span><span class="s2">&quot;isLocal&quot;</span><span class="p">])</span>

<span class="c1"># Create the stream subscribers based on provided stream list in stream_list</span>
<span class="k">def</span> <span class="nf">create_stream_subscribers</span><span class="p">():</span>
  <span class="k">for</span> <span class="n">stream</span> <span class="ow">in</span> <span class="n">stream_list</span><span class="p">:</span>
    <span class="n">create_subscriber</span><span class="p">(</span><span class="n">stream</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">stream</span><span class="p">[</span><span class="s2">&quot;isLocal&quot;</span><span class="p">])</span>

<span class="c1"># Create the stream publisher based on provided stream list in stream_list</span>
<span class="k">def</span> <span class="nf">create_stream_publisher</span><span class="p">():</span>
  <span class="k">for</span> <span class="n">stream</span> <span class="ow">in</span> <span class="n">stream_list</span><span class="p">:</span>
    <span class="n">create_publisher</span><span class="p">(</span><span class="n">stream</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">stream</span><span class="p">[</span><span class="s2">&quot;isLocal&quot;</span><span class="p">])</span>

<span class="c1"># Create the new fabric</span>
<span class="k">def</span> <span class="nf">create_new_fabrics</span><span class="p">():</span>
  <span class="k">global</span> <span class="n">active_fabric</span>
  <span class="n">local_dc</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_local_dc</span><span class="p">()</span>
  <span class="n">local_dc_name</span> <span class="o">=</span> <span class="n">local_dc</span><span class="p">[</span><span class="s2">&quot;_key&quot;</span><span class="p">]</span>
  <span class="n">all_dc_list</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_dc_list</span><span class="p">()</span>
  <span class="n">global_dc_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span>
      <span class="k">lambda</span> <span class="n">dc_name</span><span class="p">:</span> <span class="n">dc_name</span> <span class="o">!=</span> <span class="n">local_dc_name</span><span class="p">,</span>
      <span class="n">all_dc_list</span><span class="p">))</span>
  <span class="n">existing_fabric_list</span> <span class="o">=</span> <span class="n">current_fabric</span><span class="o">.</span><span class="n">fabrics</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">fabric</span> <span class="ow">in</span> <span class="n">fabric_list</span><span class="p">:</span>
    <span class="n">create_fabric</span><span class="p">(</span><span class="n">fabric</span><span class="p">,</span> <span class="n">existing_fabric_list</span><span class="p">,</span> <span class="n">local_dc_name</span><span class="p">,</span> <span class="n">global_dc_list</span><span class="p">)</span>
  <span class="n">active_fabric</span> <span class="o">=</span> <span class="n">fabric_list</span><span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span>
      <span class="n">fabric_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">get_random_number</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">fabric_list</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
  <span class="n">use_fabric</span><span class="p">()</span>

<span class="c1"># Create the collections based on provided collection list in collection_list</span>
<span class="k">def</span> <span class="nf">create_collections</span><span class="p">():</span>
  <span class="k">for</span> <span class="n">collection</span> <span class="ow">in</span> <span class="n">collection_list</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">collection</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">COLLECTION_TYPE</span><span class="p">[</span><span class="s2">&quot;KV&quot;</span><span class="p">]:</span>
      <span class="n">create_kv_collection</span><span class="p">(</span><span class="n">collection</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">collection</span><span class="p">[</span><span class="s2">&quot;hasStream&quot;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">create_document_collection</span><span class="p">(</span>
          <span class="n">collection</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">collection</span><span class="p">[</span><span class="s2">&quot;hasStream&quot;</span><span class="p">],</span> <span class="n">collection</span><span class="p">[</span><span class="s2">&quot;isEdge&quot;</span><span class="p">])</span>

<span class="c1"># Create the query workers based on provided query worker list in query_worker_list</span>
<span class="k">def</span> <span class="nf">create_query_workers</span><span class="p">():</span>
  <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">query_worker_list</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">existing_query_workers</span> <span class="o">=</span> <span class="n">current_fabric</span><span class="o">.</span><span class="n">get_all_restql</span><span class="p">()</span>
    <span class="n">existing_query_workers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
        <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">query_worker</span><span class="p">:</span> <span class="n">query_worker</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">existing_query_workers</span><span class="p">))</span>
    <span class="n">create_query_worker</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">existing_query_workers</span><span class="p">)</span>
    <span class="n">info</span><span class="p">[</span><span class="s2">&quot;noOfQueryWorker&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c1"># Create the subscriber based on provided collection list in collection_list</span>
<span class="k">def</span> <span class="nf">create_collections_subscribers</span><span class="p">():</span>
  <span class="n">_collectionList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span>
      <span class="k">lambda</span> <span class="n">collection</span><span class="p">:</span> <span class="n">collection</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">COLLECTION_TYPE</span><span class="p">[</span><span class="s2">&quot;DOCUMENT&quot;</span><span class="p">],</span> <span class="n">collection_list</span><span class="p">))</span>
  <span class="k">for</span> <span class="n">collection</span> <span class="ow">in</span> <span class="n">_collectionList</span><span class="p">:</span>
    <span class="n">create_subscriber</span><span class="p">(</span><span class="n">collection</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">is_collection_stream</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Create the graphs based on provided graph list in graph_list</span>
<span class="k">def</span> <span class="nf">create_graphs</span><span class="p">():</span>
  <span class="k">for</span> <span class="n">graph</span> <span class="ow">in</span> <span class="n">graph_list</span><span class="p">:</span>
    <span class="n">crate_graph</span><span class="p">(</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">graph</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;edgeDefinitions&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>

<span class="c1"># Create the stream worker based on provided stream list in streamAppList</span>
<span class="k">def</span> <span class="nf">create_stream_workers</span><span class="p">():</span>
  <span class="n">stream_app_list</span> <span class="o">=</span> <span class="n">current_fabric</span><span class="o">.</span><span class="n">retrive_stream_app</span><span class="p">()</span>
  <span class="n">stream_app_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
      <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">stream_app</span><span class="p">:</span> <span class="n">stream_app</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">stream_app_list</span><span class="p">[</span><span class="s2">&quot;streamApps&quot;</span><span class="p">]))</span>
  <span class="k">for</span> <span class="n">worker</span> <span class="ow">in</span> <span class="n">stream_worker_list</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">worker</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stream_app_list</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">current_fabric</span><span class="o">.</span><span class="n">create_stream_app</span><span class="p">(</span><span class="n">worker</span><span class="p">[</span><span class="s2">&quot;definition&quot;</span><span class="p">])</span>
        <span class="n">info</span><span class="p">[</span><span class="s2">&quot;noOfStreamWorker&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c1"># Activate the stream worker based on provided stream list in stream_worker_list</span>
<span class="k">def</span> <span class="nf">activate_stream_workers</span><span class="p">(</span><span class="n">is_active</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">worker</span> <span class="ow">in</span> <span class="n">stream_worker_list</span><span class="p">:</span>
    <span class="n">current_fabric</span><span class="o">.</span><span class="n">stream_app</span><span class="p">(</span><span class="n">worker</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">change_state</span><span class="p">(</span><span class="n">is_active</span><span class="p">)</span>

<span class="c1"># set current fabric to jsc8 client</span>
<span class="k">def</span> <span class="nf">use_fabric</span><span class="p">():</span>
  <span class="k">global</span> <span class="n">current_fabric</span>
  <span class="n">current_fabric</span> <span class="o">=</span> <span class="n">tenant</span><span class="o">.</span><span class="n">useFabric</span><span class="p">(</span><span class="n">active_fabric</span><span class="p">)</span>
  <span class="n">log</span><span class="p">(</span><span class="s2">&quot;Using fabric </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">active_fabric</span><span class="p">))</span>

<span class="c1"># Execute all the query workers provided in the query_worker_list</span>
<span class="c1"># for every document collection present in collection_list</span>
<span class="k">def</span> <span class="nf">execute_query_workers</span><span class="p">():</span>
  <span class="k">for</span> <span class="n">query</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">query_worker_list</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">collection</span> <span class="ow">in</span> <span class="n">collection_list</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">collection</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">COLLECTION_TYPE</span><span class="p">[</span><span class="s2">&quot;DOCUMENT&quot;</span><span class="p">]:</span>
        <span class="n">current_fabric</span><span class="o">.</span><span class="n">execute_restql</span><span class="p">(</span>
            <span class="s2">&quot;</span><span class="si">{collectionName}</span><span class="s2">_</span><span class="si">{queryWorkerName}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">collectionName</span><span class="o">=</span><span class="n">collection</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">queryWorkerName</span><span class="o">=</span><span class="n">value</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]),</span>
            <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="p">{}))</span>

<span class="c1"># Read the websocket data and verify the number of operations</span>
<span class="k">def</span> <span class="nf">verify_streams</span><span class="p">():</span>
  <span class="c1"># Waiting for 5 seconds so subscriber receives all the data</span>
  <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">stream</span> <span class="ow">in</span> <span class="n">stream_list</span><span class="p">:</span>
    <span class="n">wsData</span> <span class="o">=</span> <span class="n">web_socket_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stream</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">wsData</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">wsData</span><span class="p">[</span><span class="n">DOCUMENT_OPERATIONS</span><span class="p">[</span><span class="s2">&quot;INSERT&quot;</span><span class="p">]])</span> <span class="o">==</span> <span class="n">stream</span><span class="p">[</span><span class="s2">&quot;noOfInsertOperation&quot;</span><span class="p">]</span> <span class="ow">and</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">wsData</span><span class="p">[</span><span class="n">DOCUMENT_OPERATIONS</span><span class="p">[</span><span class="s2">&quot;UPDATE&quot;</span><span class="p">]])</span> <span class="o">==</span> <span class="n">stream</span><span class="p">[</span><span class="s2">&quot;noOfUpdateOperation&quot;</span><span class="p">]</span> <span class="ow">and</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">wsData</span><span class="p">[</span><span class="n">DOCUMENT_OPERATIONS</span><span class="p">[</span><span class="s2">&quot;DELETE&quot;</span><span class="p">]])</span> <span class="o">==</span> <span class="n">stream</span><span class="p">[</span><span class="s2">&quot;noOfDeleteOperations&quot;</span><span class="p">]):</span>
      <span class="n">log</span><span class="p">(</span><span class="s2">&quot;Websocket data validation failed for </span><span class="si">{streamName}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
          <span class="n">streamName</span><span class="o">=</span><span class="n">stream</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]))</span>

<span class="c1"># Validate the collection stream websocket data and operations</span>
<span class="k">def</span> <span class="nf">verify_collection_stream</span><span class="p">():</span>
  <span class="c1"># Waiting for 5 seconds so subscriber receives all the data</span>
  <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
  <span class="n">tmpCol</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span>
      <span class="k">lambda</span> <span class="n">collection</span><span class="p">:</span> <span class="n">collection</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">COLLECTION_TYPE</span><span class="p">[</span><span class="s2">&quot;DOCUMENT&quot;</span><span class="p">],</span> <span class="n">collection_list</span><span class="p">))</span>
  <span class="k">for</span> <span class="n">collection</span> <span class="ow">in</span> <span class="n">tmpCol</span><span class="p">:</span>
    <span class="n">wsData</span> <span class="o">=</span> <span class="n">web_socket_data</span><span class="p">[</span><span class="n">collection</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">wsData</span> <span class="ow">and</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">wsData</span><span class="p">[</span><span class="n">DOCUMENT_OPERATIONS</span><span class="p">[</span><span class="s2">&quot;INSERT&quot;</span><span class="p">]])</span> <span class="o">==</span> <span class="n">collection</span><span class="p">[</span><span class="s2">&quot;noOfInsertOperation&quot;</span><span class="p">]</span> <span class="ow">and</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">wsData</span><span class="p">[</span><span class="n">DOCUMENT_OPERATIONS</span><span class="p">[</span><span class="s2">&quot;UPDATE&quot;</span><span class="p">]])</span> <span class="o">==</span> <span class="n">collection</span><span class="p">[</span><span class="s2">&quot;noOfUpdateOperation&quot;</span><span class="p">]</span> <span class="ow">and</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">wsData</span><span class="p">[</span><span class="n">DOCUMENT_OPERATIONS</span><span class="p">[</span><span class="s2">&quot;DELETE&quot;</span><span class="p">]])</span> <span class="o">==</span> <span class="n">collection</span><span class="p">[</span><span class="s2">&quot;noOfDeleteOperations&quot;</span><span class="p">]):</span>
      <span class="n">log</span><span class="p">(</span><span class="s2">&quot;Websocket data validation failed for collection </span><span class="si">{collectionName}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
          <span class="n">collectionName</span><span class="o">=</span><span class="n">collection</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]))</span>

<span class="c1"># Delete all the query workers present in the fabric</span>
<span class="k">def</span> <span class="nf">delete_query_workers</span><span class="p">():</span>
  <span class="n">query_worker_list</span> <span class="o">=</span> <span class="n">current_fabric</span><span class="o">.</span><span class="n">get_all_restql</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">query</span> <span class="ow">in</span> <span class="n">query_worker_list</span><span class="p">:</span>
    <span class="n">current_fabric</span><span class="o">.</span><span class="n">delete_restql</span><span class="p">(</span><span class="n">query</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>

<span class="c1"># Delete all the graphs present in the fabric</span>
<span class="k">def</span> <span class="nf">delete_graphs</span><span class="p">():</span>
  <span class="n">graph_list</span> <span class="o">=</span> <span class="n">current_fabric</span><span class="o">.</span><span class="n">graphs</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">graph</span> <span class="ow">in</span> <span class="n">graph_list</span><span class="p">:</span>
    <span class="n">current_fabric</span><span class="o">.</span><span class="n">delete_graph</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">drop_collections</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Delete all the collection present in the fabric</span>
<span class="k">def</span> <span class="nf">delete_collections</span><span class="p">():</span>
  <span class="n">collection_list</span> <span class="o">=</span> <span class="n">current_fabric</span><span class="o">.</span><span class="n">collections</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">collection</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span>
          <span class="k">lambda</span> <span class="n">collection</span><span class="p">:</span> <span class="ow">not</span> <span class="n">collection</span><span class="p">[</span><span class="s2">&quot;system&quot;</span><span class="p">],</span>
          <span class="n">collection_list</span><span class="p">)):</span>
    <span class="n">current_fabric</span><span class="o">.</span><span class="n">delete_collection</span><span class="p">(</span><span class="n">collection</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>

<span class="c1"># Delete all the fabric workers present in the fabric_list</span>
<span class="k">def</span> <span class="nf">delete_fabrics</span><span class="p">():</span>
  <span class="k">for</span> <span class="n">fabric</span> <span class="ow">in</span> <span class="n">fabric_list</span><span class="p">:</span>
    <span class="n">current_fabric</span><span class="o">.</span><span class="n">delete_fabric</span><span class="p">(</span><span class="n">fabric</span><span class="p">)</span>

<span class="c1"># Terminate all the websocket</span>
<span class="k">def</span> <span class="nf">clear_web_socket</span><span class="p">():</span>
  <span class="k">for</span> <span class="n">web_socket</span> <span class="ow">in</span> <span class="n">web_socket_list</span><span class="p">:</span>
    <span class="n">web_socket</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># Delete all the streams present in the fabric</span>
<span class="k">def</span> <span class="nf">delete_streams</span><span class="p">():</span>
  <span class="n">streams_list</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">global_stream</span> <span class="o">=</span> <span class="n">current_fabric</span><span class="o">.</span><span class="n">streams</span><span class="p">()</span>
  <span class="n">local_stream</span> <span class="o">=</span> <span class="n">current_fabric</span><span class="o">.</span><span class="n">streams</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
  <span class="n">streams_list</span> <span class="o">=</span> <span class="n">global_stream</span> <span class="o">+</span> <span class="n">local_stream</span>

  <span class="k">def</span> <span class="nf">response_handler</span><span class="p">(</span><span class="n">resp</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">resp</span><span class="o">.</span><span class="n">is_success</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Failed to delete stream: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">stream</span> <span class="ow">in</span> <span class="n">streams_list</span><span class="p">:</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span>
        <span class="n">method</span><span class="o">=</span><span class="s1">&#39;delete&#39;</span><span class="p">,</span>
        <span class="n">endpoint</span><span class="o">=</span><span class="s1">&#39;/streams/</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stream</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>
    <span class="p">)</span>
    <span class="c1"># In upcoming release this API call will be replaced by pyc8 internal function</span>
    <span class="n">current_fabric</span><span class="o">.</span><span class="n">_execute</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">response_handler</span><span class="p">)</span>

<span class="c1"># Delete all the streams worker present in the fabric</span>
<span class="k">def</span> <span class="nf">delete_stream_worker</span><span class="p">():</span>
  <span class="n">all_steam_apps</span> <span class="o">=</span> <span class="n">current_fabric</span><span class="o">.</span><span class="n">retrive_stream_app</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">stream_app</span> <span class="ow">in</span> <span class="n">all_steam_apps</span><span class="p">[</span><span class="s2">&quot;streamApps&quot;</span><span class="p">]:</span>
    <span class="n">current_fabric</span><span class="o">.</span><span class="n">stream_app</span><span class="p">(</span><span class="n">stream_app</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>

<span class="c1"># It will delete the query-workers, graphs, collections, streams, stream-workers and fabric</span>
<span class="k">def</span> <span class="nf">clear</span><span class="p">():</span>
  <span class="k">global</span> <span class="n">active_fabric</span>
  <span class="n">use_fabric</span><span class="p">()</span>
  <span class="n">delete_query_workers</span><span class="p">()</span>
  <span class="n">delete_graphs</span><span class="p">()</span>
  <span class="n">delete_collections</span><span class="p">()</span>
  <span class="n">delete_streams</span><span class="p">()</span>
  <span class="n">delete_stream_worker</span><span class="p">()</span>
  <span class="n">active_fabric</span> <span class="o">=</span> <span class="s2">&quot;_system&quot;</span>
  <span class="n">use_fabric</span><span class="p">()</span>
  <span class="n">delete_fabrics</span><span class="p">()</span>
  <span class="n">clear_web_socket</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="create-ci-cd-pipeline">
<h2>4. Create CI/CD Pipeline<a class="headerlink" href="#create-ci-cd-pipeline" title="Permalink to this headline">¶</a></h2>
<p>Below function contains the list of sub functions.Each subfunction is responsible for either creating or deleting the elements in the GDN.</p>
<p>Current flow is as below</p>
<ul class="simple">
<li><p>Create fabrics</p></li>
<li><p>Pick any random fabric from created fabric</p></li>
<li><p>Create collections</p></li>
<li><p>Create query worker for each collection</p></li>
<li><p>Create stream workers</p></li>
<li><p>Activate the stream workers</p></li>
<li><p>Create the collection subscribers</p></li>
<li><p>Execute the query workers</p></li>
<li><p>Execute the CRUD using import API and truncate the collection. This operation is operformed on each collection</p></li>
<li><p>Validate the collection streams after query worker and CRUD operation execution with expected output</p></li>
<li><p>Create streams</p></li>
<li><p>Create the stream subscribers</p></li>
<li><p>Create the stream publisher. Publisher is pushing some records in the streams</p></li>
<li><p>Verify the stream output by counting the number of object received in the stream.</p></li>
<li><p>Unpublish the stream worker</p></li>
<li><p>Delete all the queryworkers, all the graphs, all the collections, all the streams, all the stream workers, and delete the number of fabric we created in the starting of program</p></li>
</ul>
<p>If you want to customize the CI/CD pipeline then please comment the appropriate steps and modify the CI/CD pipeline.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># It will execute GDN pipeline in series manner</span>
<span class="k">def</span> <span class="nf">execute_cicd_pipeline</span><span class="p">():</span>

    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ------- CREATE FABRICS ------&quot;</span><span class="p">)</span>
    <span class="n">create_new_fabrics</span><span class="p">()</span>
    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ------- CREATED FABRICS ------&quot;</span><span class="p">)</span>

    <span class="n">use_fabric</span><span class="p">()</span>

    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ------- CREATE GEO-REPLICATED COLLECTION  ------&quot;</span><span class="p">)</span>
    <span class="n">create_collections</span><span class="p">()</span>
    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ------- CREATED GEO-REPLICATED COLLECTION  ------&quot;</span><span class="p">)</span>

    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ------- CREATE GRAPHS ------&quot;</span><span class="p">)</span>
    <span class="n">create_graphs</span><span class="p">()</span>
    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ------- CREATED GRAPHS  ------&quot;</span><span class="p">)</span>

    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ------- CREATE QUERY WORKER  ------&quot;</span><span class="p">)</span>
    <span class="n">create_query_workers</span><span class="p">()</span>
    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ------- CREATED QUERY WORKER  ------&quot;</span><span class="p">)</span>

    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ------- CREATE STREAM WORKERS  ------&quot;</span><span class="p">)</span>
    <span class="n">create_stream_workers</span><span class="p">()</span>
    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ------- CREATED STREAM WORKERS  ------&quot;</span><span class="p">)</span>

    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ------- PUBLISH STREAM WORKERS  ------&quot;</span><span class="p">)</span>
    <span class="n">activate_stream_workers</span><span class="p">()</span>
    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ------- PUBLISH STREAM WORKERS  ------&quot;</span><span class="p">)</span>
    
    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ------- CREATE COLLECTION SUBSCRIBER  ------&quot;</span><span class="p">)</span>
    <span class="n">create_collections_subscribers</span><span class="p">()</span>
    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ------- CREATED COLLECTION SUBSCRIBER  ------&quot;</span><span class="p">)</span>

    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ------- EXECUTE CRUD USING QUERY WORKER ------&quot;</span><span class="p">)</span>
    <span class="n">execute_query_workers</span><span class="p">()</span>
    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ------- EXECUTED CRUD USING QUERY WORKER ------&quot;</span><span class="p">)</span>

    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ------- VERIFY COLLECTION STREAM ------&quot;</span><span class="p">)</span>
    <span class="n">verify_collection_stream</span><span class="p">()</span>
    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ------- VERIFIED COLLECTION STREAM ------&quot;</span><span class="p">)</span>

    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ------- CREATE STREAM ------&quot;</span><span class="p">)</span>
    <span class="n">create_streams</span><span class="p">()</span>
    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ------- CREATED STREAM ------&quot;</span><span class="p">)</span>

    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ------- SUBSCRIBE STREAM ------&quot;</span><span class="p">)</span>
    <span class="n">create_stream_subscribers</span><span class="p">()</span>
    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ------- SUBSCRIBED STREAM ------&quot;</span><span class="p">)</span>
    
    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ------- CREATE STREAM PRODUCER ------&quot;</span><span class="p">)</span>
    <span class="n">create_stream_publisher</span><span class="p">()</span>
    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ------- CREATED STREAM PRODUCER ------&quot;</span><span class="p">)</span>

    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ------- VERIFY STREAM ------&quot;</span><span class="p">)</span>
    <span class="n">verify_streams</span><span class="p">()</span>
    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ------- VERIFIED STREAM ------&quot;</span><span class="p">)</span>

    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ------- UNPUBLISH STREAM WORKERS  ------&quot;</span><span class="p">)</span>
    <span class="n">activate_stream_workers</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ------- UNPUBLISH STREAM WORKERS  ------&quot;</span><span class="p">)</span>

    <span class="c1"># clearing everything from previous runs</span>
    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ------- CLEARING ------&quot;</span><span class="p">)</span>
    <span class="n">clear</span><span class="p">()</span>
    <span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ------- CLEARED  ------&quot;</span><span class="p">)</span>

    <span class="n">log</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="execute-ci-cd-script">
<h2>5. Execute CI/CD script<a class="headerlink" href="#execute-ci-cd-script" title="Permalink to this headline">¶</a></h2>
<p>Below function is executing the CI/CD pipeline.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Execute the CI/CD pipeline</span>
<span class="n">execute_cicd_pipeline</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="section-completed">
<h2>Section Completed!<a class="headerlink" href="#section-completed" title="Permalink to this headline">¶</a></h2>
<p>Congratulations! you have completed this tutorial.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./python"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="08_stream_worker%28Python%29.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Py08 - Stream Workers</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../javascript/beginner_toc.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Javascript</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By The Macrometa Team<br/>
    
        &copy; Copyright 2022.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>